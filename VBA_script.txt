Sub StockData()Dim total As DoubleDim i As LongDim YearlyChange As DoubleDim j As IntegerDim start As LongDim rowCount As LongDim percentChange As DoubleDim days As IntegerDim dailyChange As DoubleDim averageChange As DoubleDim ws As WorksheetDim ticker As StringDim closingprice As LongDim openingprice As LongDim sRow As LongFor Each ws In ThisWorkbook.Worksheets    total = 0    openingprice = ws.Cells(2, 3).Value                sRow = 2        'Output table    ws.Cells(1, 9).Value = "Ticker"    ws.Cells(1, 10).Value = "Yearly Change"    ws.Cells(1, 11).Value = "Percent Change"    ws.Cells(1, 12).Value = "Total Stock Volume"        rowCount = ws.Cells(Rows.Count, 1).End(xlUp).Row        'Looping through 2 to last row    For i = 2 To rowCount    ticker = ws.Cells(i, 1).Value    If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then            total = total + ws.Cells(i, 7).Value                        closingprice = ws.Cells(i, 6).Value                        YearlyChange = closingprice - openingprice        'Conditional permittingon yearly change    If YearlyChange > 0 Then    ws.Cells(sRow, 10).Interior.ColorIndex = 4    Else    ws.Cells(sRow, 10).Interior.ColorIndex = 3    End If        If openingprice = 0 Then    percentChange = 0    Else    percentChange = YearlyChange / openingprice    End If        'Assigning new column values to respective columns    ws.Cells(sRow, 9).Value = ticker    ws.Cells(sRow, 10).Value = YearlyChange    ws.Cells(sRow, 11).Value = percentChange    ws.Cells(sRow, 11).NumberFormat = "0.00%"    ws.Cells(sRow, 12).Value = total        sRow = sRow + 1    total = 0    openingprice = ws.Cells(i + 1, 3).Value    Else    YearlyChange = closingprice - openingprice    total = total + ws.Cells(i, 7).Value    End If    Next i    Next ws    End Sub